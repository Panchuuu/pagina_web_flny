<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mi Perfil - Flaites NY</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/style/style.css">
    <link rel="icon" type="image/png" href="assets/img/logo_tienda.png" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@400;700;900&family=Inter:wght@400;700&display=swap" rel="stylesheet" />
</head>
<body class="bg-dark text-white">
    <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1100"></div>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark-secondary border-bottom border-secondary sticky-top">
        <div class="container">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse w-100" id="mainNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Inicio</a></li>
                    <li class="nav-item" id="admin-link" style="display: none;"><a class="nav-link text-danger fw-bold" href="admin-dashboard.html">Admin</a></li>
                    <li class="nav-item"><a class="nav-link" href="catalogo.html">Tienda VIP</a></li>
                    <li class="nav-item"><a class="nav-link" href="normativas.html">Normativas</a></li>
                    <li class="nav-item"><a class="nav-link" href="https://discord.com/tu-servidor" target="_blank">Discord</a></li>
                </ul>
                <div class="d-flex align-items-center">
                    <div id="guest-container"><a href="login.html" class="btn btn-outline-warning btn-sm">Iniciar Sesión</a></div>
                    <div id="user-container" class="dropdown" style="display: none;">
                        <a href="#" class="nav-link dropdown-toggle d-flex align-items-center" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user-circle me-2"></i> Hola, <span id="username-span" class="fw-bold ms-1"></span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end">
                            <li><a class="dropdown-item active" href="perfil.html"><i class="fas fa-history me-2"></i>Ver historial de compras</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><button class="dropdown-item text-danger" onclick="handleLogout()"><i class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión</button></li>
                        </ul>
                    </div>
                    <a href="carro.html" class="position-relative ms-3" title="Ver carro">
                        <img src="assets/img/carrito-de-compras.png" alt="carro" style="height:24px;">
                        <span id="cart-counter" class="cart-counter-badge">0</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <main class="container my-5">
        <div id="loading-spinner" class="text-center mt-5">
            <div class="spinner-border text-warning" style="width: 3rem; height: 3rem;" role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
        </div>

        <div id="profile-content" class="row d-none"> <div class="col-lg-4 mb-4">
                <div class="card bg-dark-secondary border-secondary h-100">
                    <div class="card-body text-center p-4">
                        <img id="profile-avatar" src="" alt="Avatar de Discord" class="rounded-circle mb-3" style="width: 100px; height: 100px;">
                        <h3 id="profile-username" class="text-uppercase fw-bold"></h3>
                        <hr class="border-secondary">
                        <div class="text-start">
                            <p class="text-muted mb-1"><i class="fab fa-discord me-2"></i>Discord ID</p>
                            <p id="profile-discord-id" class="fw-light"></p>
                            <p class="text-muted mb-1"><i class="fas fa-gamepad me-2"></i>FiveM License</p>
                            <p id="profile-fivem-license" class="fw-light text-break"></p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-8">
                <h4 class="text-uppercase fw-bold mb-4">Roles Activos en Discord</h4>
                <div id="active-roles-container" class="d-flex flex-wrap gap-2 mb-5">
                    </div>

                <h4 class="text-uppercase fw-bold mb-4">Historial de Compras</h4>
                <div class="card bg-dark-secondary border-secondary">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-dark table-hover mb-0">
                                <thead><tr><th>Producto</th><th>Cantidad</th><th>Total Pagado</th><th>Fecha</th></tr></thead>
                                <tbody id="purchase-history-container"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div class="container">
        <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top border-secondary">
            <p class="col-md-4 mb-0 text-muted-dark">© 2025 Flaites NY Roleplay</p>
            <a href="index.html" class="col-md-4 d-flex align-items-center justify-content-center mb-3 mb-md-0 me-md-auto text-decoration-none">
                <img src="assets/img/logo_tienda.png" alt="Logo Flaites NY" width="50" />
            </a>
            <ul class="nav col-md-4 justify-content-end">
                <li class="nav-item"><a href="terminos.html" class="nav-link px-2 footer-link-simple">Términos</a></li>
                <li class="nav-item"><a href="https://discord.com/tu-servidor" target="_blank" class="nav-link px-2 footer-link-simple" title="Discord"><i class="fab fa-discord fa-lg"></i></a></li>
                <li class="nav-item"><a href="https://www.instagram.com/" target="_blank" class="nav-link px-2 footer-link-simple" title="Instagram"><i class="fab fa-instagram fa-lg"></i></a></li>
                <li class="nav-item"><a href="https://www.tiktok.com/es/" target="_blank" class="nav-link px-2 footer-link-simple" title="TikTok"><i class="fab fa-tiktok fa-lg"></i></a></li>
            </ul>
        </footer>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/notifications.js"></script>
    <script src="assets/js/auth.js"></script>
    <script src="assets/js/app.js"></script>
</body>
</html>